% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/windowing.R
\name{calc_smoothed_windows}
\alias{calc_smoothed_windows}
\title{Calculate smoothed methylation windows}
\usage{
calc_smoothed_windows(
  h5_paths,
  chr_index,
  metadata,
  type = "CG",
  step = 500,
  smooth = 3,
  kernel = "uniform",
  group_by = "cluster_id",
  genome = "hg38",
  threads = 1,
  chrList = NULL,
  chrSizes = NULL,
  return_sum_matrix = TRUE,
  return_pct_matrix = TRUE
)
}
\arguments{
\item{h5_paths}{data.table with columns: barcode, path}

\item{chr_index}{Optimized index from create_optimized_index()}

\item{metadata}{data.table with cell metadata including grouping column}

\item{type}{Character, methylation context ("CG" or "CH")}

\item{step}{Integer, window step size in bp (default: 500)}

\item{smooth}{Integer, kernel size for smoothing (default: 3)}

\item{kernel}{Character or numeric vector specifying kernel type:
"uniform" (default), "gaussian", "triangular", or custom weights}

\item{group_by}{Character, column name in metadata for grouping (default: "cluster_id")}

\item{genome}{Character, genome build (default: "hg38")}

\item{threads}{Integer, number of threads (default: 1)}

\item{chrList}{Optional character vector of chromosomes to process}

\item{chrSizes}{Optional numeric vector matching chrList}

\item{return_sum_matrix}{Logical, return count matrix (default: TRUE)}

\item{return_pct_matrix}{Logical, return percentage matrix (default: TRUE)}
}
\value{
List with sum_matrix and/or pct_matrix based on parameters
}
\description{
Aggregates methylation data into genomic windows and applies kernel smoothing
to reduce sparsity. Cells are pooled within groups before smoothing.
}
\examples{
\dontrun{
# Create index first
index <- create_optimized_index(h5_paths, type = "CG")

# Calculate smoothed windows
result <- calc_smoothed_windows(
  h5_paths = h5_paths,
  chr_index = index,
  metadata = metadata,
  group_by = "cluster_id",
  threads = 4
)
}
}
